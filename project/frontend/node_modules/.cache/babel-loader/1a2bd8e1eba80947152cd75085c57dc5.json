{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Alert from\"react-bootstrap/Alert\";import Button from\"react-bootstrap/Button\";import Col from\"react-bootstrap/Col\";import Container from\"react-bootstrap/Container\";import Form from\"react-bootstrap/Form\";import Row from\"react-bootstrap/Row\";import{useHistory,useParams}from\"react-router-dom\";import{axiosRes}from\"../../api/axiosDefaults\";import{useCurrentUser,useSetCurrentUser}from\"../../contexts/CurrentUserContext\";import btnStyles from\"../../styles/Button.module.css\";import appStyles from\"../../App.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UsernameForm=function UsernameForm(){var _errors$username;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),errors=_useState4[0],setErrors=_useState4[1];var history=useHistory();var _useParams=useParams(),id=_useParams.id;var currentUser=useCurrentUser();var setCurrentUser=useSetCurrentUser();useEffect(function(){var _currentUser$profile_;if((currentUser===null||currentUser===void 0?void 0:(_currentUser$profile_=currentUser.profile_id)===null||_currentUser$profile_===void 0?void 0:_currentUser$profile_.toString())===id){setUsername(currentUser.username);}else{history.push(\"/\");}},[currentUser,history,id]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var _err$response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return axiosRes.put(\"/dj-rest-auth/user/\",{username:username});case 4:setCurrentUser(function(prevUser){return _objectSpread(_objectSpread({},prevUser),{},{username:username});});history.goBack();_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);console.log(_context.t0);setErrors((_err$response=_context.t0.response)===null||_err$response===void 0?void 0:_err$response.data);case 12:case\"end\":return _context.stop();}},_callee,null,[[1,8]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{className:\"py-2 mx-auto text-center\",md:6,children:/*#__PURE__*/_jsx(Container,{className:appStyles.Content,children:/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,className:\"my-2\",children:[/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Change username\"}),/*#__PURE__*/_jsx(Form.Control,{placeholder:\"username\",type:\"text\",value:username,onChange:function onChange(event){return setUsername(event.target.value);}})]}),errors===null||errors===void 0?void 0:(_errors$username=errors.username)===null||_errors$username===void 0?void 0:_errors$username.map(function(message,idx){return/*#__PURE__*/_jsx(Alert,{variant:\"warning\",children:message},idx);}),/*#__PURE__*/_jsx(Button,{className:\"\".concat(btnStyles.Button,\" \").concat(btnStyles.Blue),onClick:function onClick(){return history.goBack();},children:\"cancel\"}),/*#__PURE__*/_jsx(Button,{className:\"\".concat(btnStyles.Button,\" \").concat(btnStyles.Blue),type:\"submit\",children:\"save\"})]})})})});};export default UsernameForm;","map":{"version":3,"names":["React","useEffect","useState","Alert","Button","Col","Container","Form","Row","useHistory","useParams","axiosRes","useCurrentUser","useSetCurrentUser","btnStyles","appStyles","jsx","_jsx","jsxs","_jsxs","UsernameForm","_errors$username","_useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","errors","setErrors","history","_useParams","id","currentUser","setCurrentUser","_currentUser$profile_","profile_id","toString","push","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","_err$response","wrap","_callee$","_context","prev","next","preventDefault","put","prevUser","_objectSpread","goBack","t0","console","log","response","data","stop","_x","apply","arguments","children","className","md","Content","onSubmit","Group","Label","Control","placeholder","type","value","onChange","target","map","message","idx","variant","concat","Blue","onClick"],"sources":["/workspace/api-django/project/frontend/src/pages/profiles/UsernameForm.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nimport Alert from \"react-bootstrap/Alert\";\nimport Button from \"react-bootstrap/Button\";\nimport Col from \"react-bootstrap/Col\";\nimport Container from \"react-bootstrap/Container\";\nimport Form from \"react-bootstrap/Form\";\nimport Row from \"react-bootstrap/Row\";\n\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { axiosRes } from \"../../api/axiosDefaults\";\nimport {\n  useCurrentUser,\n  useSetCurrentUser,\n} from \"../../contexts/CurrentUserContext\";\n\nimport btnStyles from \"../../styles/Button.module.css\";\nimport appStyles from \"../../App.module.css\";\n\nconst UsernameForm = () => {\n  const [username, setUsername] = useState(\"\");\n  const [errors, setErrors] = useState({});\n\n  const history = useHistory();\n  const { id } = useParams();\n\n  const currentUser = useCurrentUser();\n  const setCurrentUser = useSetCurrentUser();\n\n  useEffect(() => {\n    if (currentUser?.profile_id?.toString() === id) {\n      setUsername(currentUser.username);\n    } else {\n      history.push(\"/\");\n    }\n  }, [currentUser, history, id]);\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    try {\n      await axiosRes.put(\"/dj-rest-auth/user/\", {\n        username,\n      });\n      setCurrentUser((prevUser) => ({\n        ...prevUser,\n        username,\n      }));\n      history.goBack();\n    } catch (err) {\n      console.log(err);\n      setErrors(err.response?.data);\n    }\n  };\n\n  return (\n    <Row>\n      <Col className=\"py-2 mx-auto text-center\" md={6}>\n        <Container className={appStyles.Content}>\n          <Form onSubmit={handleSubmit} className=\"my-2\">\n            <Form.Group>\n              <Form.Label>Change username</Form.Label>\n              <Form.Control\n                placeholder=\"username\"\n                type=\"text\"\n                value={username}\n                onChange={(event) => setUsername(event.target.value)}\n              />\n            </Form.Group>\n            {errors?.username?.map((message, idx) => (\n              <Alert key={idx} variant=\"warning\">\n                {message}\n              </Alert>\n            ))}\n            <Button\n              className={`${btnStyles.Button} ${btnStyles.Blue}`}\n              onClick={() => history.goBack()}\n            >\n              cancel\n            </Button>\n            <Button\n              className={`${btnStyles.Button} ${btnStyles.Blue}`}\n              type=\"submit\"\n            >\n              save\n            </Button>\n          </Form>\n        </Container>\n      </Col>\n    </Row>\n  );\n};\n\nexport default UsernameForm;"],"mappings":"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"},"metadata":{},"sourceType":"module"}