{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{Media}from\"react-bootstrap\";import{Link}from\"react-router-dom\";import Avatar from\"../../components/Avatar\";import{MoreDropdown}from\"../../components/MoreDropdown\";import CommentEditForm from\"./CommentEditForm\";import styles from\"../../styles/Comment.module.css\";import{useCurrentUser}from\"../../contexts/CurrentUserContext\";import{axiosRes}from\"../../api/axiosDefaults\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Comment=function Comment(props){var profile_id=props.profile_id,profile_image=props.profile_image,owner=props.owner,updated_at=props.updated_at,content=props.content,id=props.id,setPost=props.setPost,setComments=props.setComments;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showEditForm=_useState2[0],setShowEditForm=_useState2[1];var currentUser=useCurrentUser();var is_owner=(currentUser===null||currentUser===void 0?void 0:currentUser.username)===owner;var handleDelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosRes.delete(\"/comments/\".concat(id,\"/\"));case 3:setPost(function(prevPost){return{results:[_objectSpread(_objectSpread({},prevPost.results[0]),{},{comments_count:prevPost.results[0].comments_count-1})]};});setComments(function(prevComments){return _objectSpread(_objectSpread({},prevComments),{},{results:prevComments.results.filter(function(comment){return comment.id!==id;})});});_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function handleDelete(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(Media,{children:[/*#__PURE__*/_jsx(Link,{to:\"/profiles/\".concat(profile_id),children:/*#__PURE__*/_jsx(Avatar,{src:profile_image})}),/*#__PURE__*/_jsxs(Media.Body,{className:\"align-self-center ml-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:styles.Owner,children:owner}),/*#__PURE__*/_jsx(\"span\",{className:styles.Date,children:updated_at}),showEditForm?/*#__PURE__*/_jsx(CommentEditForm,{id:id,profile_id:profile_id,content:content,profileImage:profile_image,setComments:setComments,setShowEditForm:setShowEditForm}):/*#__PURE__*/_jsx(\"p\",{children:content})]}),is_owner&&!showEditForm&&/*#__PURE__*/_jsx(MoreDropdown,{handleEdit:function handleEdit(){return setShowEditForm(true);},handleDelete:handleDelete})]})]});};export default Comment;","map":{"version":3,"names":["React","useState","Media","Link","Avatar","MoreDropdown","CommentEditForm","styles","useCurrentUser","axiosRes","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Comment","props","profile_id","profile_image","owner","updated_at","content","id","setPost","setComments","_useState","_useState2","_slicedToArray","showEditForm","setShowEditForm","currentUser","is_owner","username","handleDelete","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","delete","concat","prevPost","results","_objectSpread","comments_count","prevComments","filter","comment","t0","stop","apply","arguments","children","to","src","Body","className","Owner","Date","profileImage","handleEdit"],"sources":["/workspace/api-django/project/frontend/src/pages/comments/Comment.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Media } from \"react-bootstrap\";\nimport { Link } from \"react-router-dom\";\nimport Avatar from \"../../components/Avatar\";\nimport { MoreDropdown } from \"../../components/MoreDropdown\";\nimport CommentEditForm from \"./CommentEditForm\";\n\nimport styles from \"../../styles/Comment.module.css\";\nimport { useCurrentUser } from \"../../contexts/CurrentUserContext\";\nimport { axiosRes } from \"../../api/axiosDefaults\";\n\nconst Comment = (props) => {\n  const {\n    profile_id,\n    profile_image,\n    owner,\n    updated_at,\n    content,\n    id,\n    setPost,\n    setComments,\n  } = props;\n\n  const [showEditForm, setShowEditForm] = useState(false);\n  const currentUser = useCurrentUser();\n  const is_owner = currentUser?.username === owner;\n\n  const handleDelete = async () => {\n    try {\n      await axiosRes.delete(`/comments/${id}/`);\n      setPost((prevPost) => ({\n        results: [\n          {\n            ...prevPost.results[0],\n            comments_count: prevPost.results[0].comments_count - 1,\n          },\n        ],\n      }));\n\n      setComments((prevComments) => ({\n        ...prevComments,\n        results: prevComments.results.filter((comment) => comment.id !== id),\n      }));\n    } catch (err) {}\n  };\n\n  return (\n    <>\n      <hr />\n      <Media>\n        <Link to={`/profiles/${profile_id}`}>\n          <Avatar src={profile_image} />\n        </Link>\n        <Media.Body className=\"align-self-center ml-2\">\n          <span className={styles.Owner}>{owner}</span>\n          <span className={styles.Date}>{updated_at}</span>\n          {showEditForm ? (\n            <CommentEditForm\n              id={id}\n              profile_id={profile_id}\n              content={content}\n              profileImage={profile_image}\n              setComments={setComments}\n              setShowEditForm={setShowEditForm}\n            />\n          ) : (\n            <p>{content}</p>\n          )}\n        </Media.Body>\n        {is_owner && !showEditForm && (\n          <MoreDropdown\n            handleEdit={() => setShowEditForm(true)}\n            handleDelete={handleDelete}\n          />\n        )}\n      </Media>\n    </>\n  );\n};\n\nexport default Comment;"],"mappings":"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"},"metadata":{},"sourceType":"module"}