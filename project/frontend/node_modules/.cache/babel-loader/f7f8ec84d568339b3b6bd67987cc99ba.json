{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{Link}from\"react-router-dom\";import Form from\"react-bootstrap/Form\";import InputGroup from\"react-bootstrap/InputGroup\";import styles from\"../../styles/CommentCreateEditForm.module.css\";import Avatar from\"../../components/Avatar\";import{axiosRes}from\"../../api/axiosDefaults\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CommentCreateForm(props){var post=props.post,setPost=props.setPost,setComments=props.setComments,profileImage=props.profileImage,profile_id=props.profile_id;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),content=_useState2[0],setContent=_useState2[1];var handleChange=function handleChange(event){setContent(event.target.value);};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var _yield$axiosRes$post,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return axiosRes.post(\"/comments/\",{content:content,post:post});case 4:_yield$axiosRes$post=_context.sent;data=_yield$axiosRes$post.data;setComments(function(prevComments){return _objectSpread(_objectSpread({},prevComments),{},{results:[data].concat(_toConsumableArray(prevComments.results))});});setPost(function(prevPost){return{results:[_objectSpread(_objectSpread({},prevPost.results[0]),{},{comments_count:prevPost.results[0].comments_count+1})]};});setContent(\"\");_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 14:case\"end\":return _context.stop();}},_callee,null,[[1,11]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Form,{className:\"mt-2\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(Form.Group,{children:/*#__PURE__*/_jsxs(InputGroup,{children:[/*#__PURE__*/_jsx(Link,{to:\"/profiles/\".concat(profile_id),children:/*#__PURE__*/_jsx(Avatar,{src:profileImage})}),/*#__PURE__*/_jsx(Form.Control,{className:styles.Form,placeholder:\"my comment...\",as:\"textarea\",value:content,onChange:handleChange,rows:2})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"\".concat(styles.Button,\" btn d-block ml-auto\"),disabled:!content.trim(),type:\"submit\",children:\"post\"})]});}export default CommentCreateForm;","map":{"version":3,"names":["React","useState","Link","Form","InputGroup","styles","Avatar","axiosRes","jsx","_jsx","jsxs","_jsxs","CommentCreateForm","props","post","setPost","setComments","profileImage","profile_id","_useState","_useState2","_slicedToArray","content","setContent","handleChange","event","target","value","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$axiosRes$post","data","wrap","_callee$","_context","prev","next","preventDefault","sent","prevComments","_objectSpread","results","concat","_toConsumableArray","prevPost","comments_count","t0","console","log","stop","_x","apply","arguments","className","onSubmit","children","Group","to","src","Control","placeholder","as","onChange","rows","Button","disabled","trim","type"],"sources":["/workspace/api-django/project/frontend/src/pages/comments/CommentCreateForm.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport Form from \"react-bootstrap/Form\";\nimport InputGroup from \"react-bootstrap/InputGroup\";\n\nimport styles from \"../../styles/CommentCreateEditForm.module.css\";\nimport Avatar from \"../../components/Avatar\";\nimport { axiosRes } from \"../../api/axiosDefaults\";\n\nfunction CommentCreateForm(props) {\n  const { post, setPost, setComments, profileImage, profile_id } = props;\n  const [content, setContent] = useState(\"\");\n\n  const handleChange = (event) => {\n    setContent(event.target.value);\n  };\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    try {\n      const { data } = await axiosRes.post(\"/comments/\", {\n        content,\n        post,\n      });\n      setComments((prevComments) => ({\n        ...prevComments,\n        results: [data, ...prevComments.results],\n      }));\n      setPost((prevPost) => ({\n        results: [\n          {\n            ...prevPost.results[0],\n            comments_count: prevPost.results[0].comments_count + 1,\n          },\n        ],\n      }));\n      setContent(\"\");\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return (\n    <Form className=\"mt-2\" onSubmit={handleSubmit}>\n      <Form.Group>\n        <InputGroup>\n          <Link to={`/profiles/${profile_id}`}>\n            <Avatar src={profileImage} />\n          </Link>\n          <Form.Control\n            className={styles.Form}\n            placeholder=\"my comment...\"\n            as=\"textarea\"\n            value={content}\n            onChange={handleChange}\n            rows={2}\n          />\n        </InputGroup>\n      </Form.Group>\n      <button\n        className={`${styles.Button} btn d-block ml-auto`}\n        disabled={!content.trim()}\n        type=\"submit\"\n      >\n        post\n      </button>\n    </Form>\n  );\n}\n\nexport default CommentCreateForm;"],"mappings":"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"},"metadata":{},"sourceType":"module"}