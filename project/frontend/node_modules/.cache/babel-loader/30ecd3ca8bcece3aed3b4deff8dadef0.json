{"ast":null,"code":"import _objectSpread from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Col from\"react-bootstrap/Col\";import Row from\"react-bootstrap/Row\";import Container from\"react-bootstrap/Container\";import appStyles from\"../../App.module.css\";import{useParams}from\"react-router\";import{axiosReq}from\"../../api/axiosDefaults\";import Post from\"./Post\";import Comment from\"../comments/Comment\";import CommentCreateForm from\"../comments/CommentCreateForm\";import{useCurrentUser}from\"../../contexts/CurrentUserContext\";import InfiniteScroll from\"react-infinite-scroll-component\";import Asset from\"../../components/Asset\";import{fetchMoreData}from\"../../utils/utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function PostPage(){var _useParams=useParams(),id=_useParams.id;var _useState=useState({results:[]}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var currentUser=useCurrentUser();var profile_image=currentUser===null||currentUser===void 0?void 0:currentUser.profile_image;var _useState3=useState({results:[]}),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];useEffect(function(){var handleMount=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,_post,_comments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all([axiosReq.get(\"/posts/\".concat(id)),axiosReq.get(\"/comments/?post=\".concat(id))]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);_post=_yield$Promise$all2[0].data;_comments=_yield$Promise$all2[1].data;setPost({results:[_post]});setComments(_comments);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return function handleMount(){return _ref.apply(this,arguments);};}();handleMount();},[id]);return/*#__PURE__*/_jsxs(Row,{className:\"h-100\",children:[/*#__PURE__*/_jsxs(Col,{className:\"py-2 p-0 p-lg-2\",lg:8,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Popular profiles for mobile\"}),/*#__PURE__*/_jsx(Post,_objectSpread(_objectSpread({},post.results[0]),{},{setPosts:setPost,postPage:true})),/*#__PURE__*/_jsxs(Container,{className:appStyles.Content,children:[currentUser?/*#__PURE__*/_jsx(CommentCreateForm,{profile_id:currentUser.profile_id,profileImage:profile_image,post:id,setPost:setPost,setComments:setComments}):comments.results.length?\"Comments\":null,comments.results.length?/*#__PURE__*/_jsx(InfiniteScroll,{children:comments.results.map(function(comment){return/*#__PURE__*/_jsx(Comment,_objectSpread(_objectSpread({},comment),{},{setPost:setPost,setComments:setComments}),comment.id);}),dataLength:comments.results.length,loader:/*#__PURE__*/_jsx(Asset,{spinner:true}),hasMore:!!comments.next,next:function next(){return fetchMoreData(comments,setComments);}}):currentUser?/*#__PURE__*/_jsx(\"span\",{children:\"No comments yet, be the first to comment!\"}):/*#__PURE__*/_jsx(\"span\",{children:\"No comments... yet\"})]})]}),/*#__PURE__*/_jsx(Col,{lg:4,className:\"d-none d-lg-block p-0 p-lg-2\",children:\"Popular profiles for desktop\"})]});}export default PostPage;","map":{"version":3,"names":["React","useEffect","useState","Col","Row","Container","appStyles","useParams","axiosReq","Post","Comment","CommentCreateForm","useCurrentUser","InfiniteScroll","Asset","fetchMoreData","jsx","_jsx","jsxs","_jsxs","PostPage","_useParams","id","_useState","results","_useState2","_slicedToArray","post","setPost","currentUser","profile_image","_useState3","_useState4","comments","setComments","handleMount","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$Promise$all","_yield$Promise$all2","_post","_comments","wrap","_callee$","_context","prev","next","Promise","all","get","concat","sent","data","t0","console","log","stop","apply","arguments","className","children","lg","_objectSpread","setPosts","postPage","Content","profile_id","profileImage","length","map","comment","dataLength","loader","spinner","hasMore"],"sources":["/workspace/api-django/project/frontend/src/pages/posts/PostPage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nimport Col from \"react-bootstrap/Col\";\nimport Row from \"react-bootstrap/Row\";\nimport Container from \"react-bootstrap/Container\";\n\nimport appStyles from \"../../App.module.css\";\nimport { useParams } from \"react-router\";\nimport { axiosReq } from \"../../api/axiosDefaults\";\nimport Post from \"./Post\";\nimport Comment from \"../comments/Comment\";\n\nimport CommentCreateForm from \"../comments/CommentCreateForm\";\nimport { useCurrentUser } from \"../../contexts/CurrentUserContext\";\n\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport Asset from \"../../components/Asset\";\nimport { fetchMoreData } from \"../../utils/utils\";\n\nfunction PostPage() {\n  const { id } = useParams();\n  const [post, setPost] = useState({ results: [] });\n\n  const currentUser = useCurrentUser();\n  const profile_image = currentUser?.profile_image;\n  const [comments, setComments] = useState({ results: [] });\n\n  useEffect(() => {\n    const handleMount = async () => {\n      try {\n        const [{ data: post }, { data: comments }] = await Promise.all([\n          axiosReq.get(`/posts/${id}`),\n          axiosReq.get(`/comments/?post=${id}`),\n        ]);\n        setPost({ results: [post] });\n        setComments(comments);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    handleMount();\n  }, [id]);\n\n  return (\n    <Row className=\"h-100\">\n      <Col className=\"py-2 p-0 p-lg-2\" lg={8}>\n        <p>Popular profiles for mobile</p>\n        <Post {...post.results[0]} setPosts={setPost} postPage />\n        <Container className={appStyles.Content}>\n          {currentUser ? (\n            <CommentCreateForm\n              profile_id={currentUser.profile_id}\n              profileImage={profile_image}\n              post={id}\n              setPost={setPost}\n              setComments={setComments}\n            />\n          ) : comments.results.length ? (\n            \"Comments\"\n          ) : null}\n          {comments.results.length ? (\n            <InfiniteScroll\n              children={comments.results.map((comment) => (\n                <Comment\n                  key={comment.id}\n                  {...comment}\n                  setPost={setPost}\n                  setComments={setComments}\n                />\n              ))}\n              dataLength={comments.results.length}\n              loader={<Asset spinner />}\n              hasMore={!!comments.next}\n              next={() => fetchMoreData(comments, setComments)}\n            />\n          ) : currentUser ? (\n            <span>No comments yet, be the first to comment!</span>\n          ) : (\n            <span>No comments... yet</span>\n          )}\n        </Container>\n      </Col>\n      <Col lg={4} className=\"d-none d-lg-block p-0 p-lg-2\">\n        Popular profiles for desktop\n      </Col>\n    </Row>\n  );\n}\n\nexport default PostPage;"],"mappings":"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"},"metadata":{},"sourceType":"module"}