{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useContext,useEffect,useState}from\"react\";import{axiosReq,axiosRes}from\"../api/axiosDefaults\";import{useCurrentUser}from\"../contexts/CurrentUserContext\";import{followHelper,unfollowHelper}from\"../utils/utils\";import{jsx as _jsx}from\"react/jsx-runtime\";var ProfileDataContext=/*#__PURE__*/createContext();var SetProfileDataContext=/*#__PURE__*/createContext();export var useProfileData=function useProfileData(){return useContext(ProfileDataContext);};export var useSetProfileData=function useSetProfileData(){return useContext(SetProfileDataContext);};export var ProfileDataProvider=function ProfileDataProvider(_ref){var children=_ref.children;var _useState=useState({// we will use the pageProfile later!\npageProfile:{results:[]},popularProfiles:{results:[]}}),_useState2=_slicedToArray(_useState,2),profileData=_useState2[0],setProfileData=_useState2[1];var currentUser=useCurrentUser();var handleFollow=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(clickedProfile){var _yield$axiosRes$post,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosRes.post(\"/followers/\",{followed:clickedProfile.id});case 3:_yield$axiosRes$post=_context.sent;data=_yield$axiosRes$post.data;setProfileData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{pageProfile:{results:prevState.pageProfile.results.map(function(profile){return followHelper(profile,clickedProfile,data.id);})},popularProfiles:_objectSpread(_objectSpread({},prevState.popularProfiles),{},{results:prevState.popularProfiles.results.map(function(profile){return followHelper(profile,clickedProfile,data.id);})})});});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 11:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function handleFollow(_x){return _ref2.apply(this,arguments);};}();var handleUnfollow=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(clickedProfile){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axiosRes.delete(\"/followers/\".concat(clickedProfile.following_id,\"/\"));case 3:setProfileData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{pageProfile:{results:prevState.pageProfile.results.map(function(profile){return unfollowHelper(profile,clickedProfile);})},popularProfiles:_objectSpread(_objectSpread({},prevState.popularProfiles),{},{results:prevState.popularProfiles.results.map(function(profile){return unfollowHelper(profile,clickedProfile);})})});});_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 9:case\"end\":return _context2.stop();}},_callee2,null,[[0,6]]);}));return function handleUnfollow(_x2){return _ref3.apply(this,arguments);};}();useEffect(function(){var handleMount=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var _yield$axiosReq$get,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axiosReq.get(\"/profiles/?ordering=-followers_count\");case 3:_yield$axiosReq$get=_context3.sent;data=_yield$axiosReq$get.data;setProfileData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{popularProfiles:data});});_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 11:case\"end\":return _context3.stop();}},_callee3,null,[[0,8]]);}));return function handleMount(){return _ref4.apply(this,arguments);};}();handleMount();},[currentUser]);return/*#__PURE__*/_jsx(ProfileDataContext.Provider,{value:profileData,children:/*#__PURE__*/_jsx(SetProfileDataContext.Provider,{value:{setProfileData:setProfileData,handleFollow:handleFollow,handleUnfollow:handleUnfollow},children:children})});};","map":{"version":3,"names":["createContext","useContext","useEffect","useState","axiosReq","axiosRes","useCurrentUser","followHelper","unfollowHelper","jsx","_jsx","ProfileDataContext","SetProfileDataContext","useProfileData","useSetProfileData","ProfileDataProvider","_ref","children","_useState","pageProfile","results","popularProfiles","_useState2","_slicedToArray","profileData","setProfileData","currentUser","handleFollow","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","clickedProfile","_yield$axiosRes$post","data","wrap","_callee$","_context","prev","next","post","followed","id","sent","prevState","_objectSpread","map","profile","t0","console","log","stop","_x","apply","arguments","handleUnfollow","_ref3","_callee2","_callee2$","_context2","delete","concat","following_id","_x2","handleMount","_ref4","_callee3","_yield$axiosReq$get","_callee3$","_context3","get","Provider","value"],"sources":["/workspace/api-django/project/frontend/src/contexts/ProfileDataContext.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from \"react\";\nimport { axiosReq, axiosRes } from \"../api/axiosDefaults\";\nimport { useCurrentUser } from \"../contexts/CurrentUserContext\";\nimport { followHelper, unfollowHelper } from \"../utils/utils\";\n\nconst ProfileDataContext = createContext();\nconst SetProfileDataContext = createContext();\n\nexport const useProfileData = () => useContext(ProfileDataContext);\nexport const useSetProfileData = () => useContext(SetProfileDataContext);\n\nexport const ProfileDataProvider = ({ children }) => {\n  const [profileData, setProfileData] = useState({\n    // we will use the pageProfile later!\n    pageProfile: { results: [] },\n    popularProfiles: { results: [] },\n  });\n\n  const currentUser = useCurrentUser();\n\n  const handleFollow = async (clickedProfile) => {\n    try {\n      const { data } = await axiosRes.post(\"/followers/\", {\n        followed: clickedProfile.id,\n      });\n\n      setProfileData((prevState) => ({\n        ...prevState,\n        pageProfile: {\n          results: prevState.pageProfile.results.map((profile) =>\n            followHelper(profile, clickedProfile, data.id)\n          ),\n        },\n        popularProfiles: {\n          ...prevState.popularProfiles,\n          results: prevState.popularProfiles.results.map((profile) =>\n            followHelper(profile, clickedProfile, data.id)\n          ),\n        },\n      }));\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const handleUnfollow = async (clickedProfile) => {\n    try {\n      await axiosRes.delete(`/followers/${clickedProfile.following_id}/`);\n\n      setProfileData((prevState) => ({\n        ...prevState,\n        pageProfile: {\n          results: prevState.pageProfile.results.map((profile) =>\n            unfollowHelper(profile, clickedProfile)\n          ),\n        },\n        popularProfiles: {\n          ...prevState.popularProfiles,\n          results: prevState.popularProfiles.results.map((profile) =>\n            unfollowHelper(profile, clickedProfile)\n          ),\n        },\n      }));\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  useEffect(() => {\n    const handleMount = async () => {\n      try {\n        const { data } = await axiosReq.get(\n          \"/profiles/?ordering=-followers_count\"\n        );\n        setProfileData((prevState) => ({\n          ...prevState,\n          popularProfiles: data,\n        }));\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    handleMount();\n  }, [currentUser]);\n\n  return (\n    <ProfileDataContext.Provider value={profileData}>\n      <SetProfileDataContext.Provider\n        value={{ setProfileData, handleFollow, handleUnfollow }}\n      >\n        {children}\n      </SetProfileDataContext.Provider>\n    </ProfileDataContext.Provider>\n  );\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}