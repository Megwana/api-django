{"ast":null,"code":"import _objectSpread from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/api-django/project/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Form from\"react-bootstrap/Form\";import Col from\"react-bootstrap/Col\";import Row from\"react-bootstrap/Row\";import Container from\"react-bootstrap/Container\";import Post from\"./Post\";import Asset from\"../../components/Asset\";import appStyles from\"../../App.module.css\";import styles from\"../../styles/PostsPage.module.css\";import{useLocation}from\"react-router\";import{axiosReq}from\"../../api/axiosDefaults\";import NoResults from\"../../assets/no-results.png\";import InfiniteScroll from\"react-infinite-scroll-component\";import{fetchMoreData}from\"../../utils/utils\";import PopularProfiles from\"../profiles/PopularProfiles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function PostsPage(_ref){var message=_ref.message,_ref$filter=_ref.filter,filter=_ref$filter===void 0?\"\":_ref$filter;var _useState=useState({results:[]}),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),hasLoaded=_useState4[0],setHasLoaded=_useState4[1];var _useLocation=useLocation(),pathname=_useLocation.pathname;var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),query=_useState6[0],setQuery=_useState6[1];useEffect(function(){var fetchPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axiosReq$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosReq.get(\"/posts/?\".concat(filter,\"search=\").concat(query));case 3:_yield$axiosReq$get=_context.sent;data=_yield$axiosReq$get.data;setPosts(data);setHasLoaded(true);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:case\"end\":return _context.stop();}},_callee,null,[[0,9]]);}));return function fetchPosts(){return _ref2.apply(this,arguments);};}();setHasLoaded(false);var timer=setTimeout(function(){fetchPosts();},1000);return function(){clearTimeout(timer);};},[filter,query,pathname]);return/*#__PURE__*/_jsxs(Row,{className:\"h-100\",children:[/*#__PURE__*/_jsxs(Col,{className:\"py-2 p-0 p-lg-2\",lg:8,children:[/*#__PURE__*/_jsx(PopularProfiles,{mobile:true}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search \".concat(styles.SearchIcon)}),/*#__PURE__*/_jsx(Form,{className:styles.SearchBar,onSubmit:function onSubmit(event){return event.preventDefault();},children:/*#__PURE__*/_jsx(Form.Control,{value:query,onChange:function onChange(event){return setQuery(event.target.value);},type:\"text\",className:\"mr-sm-2\",placeholder:\"Search posts\"})}),hasLoaded?/*#__PURE__*/_jsx(_Fragment,{children:posts.results.length?/*#__PURE__*/_jsx(InfiniteScroll,{children:posts.results.map(function(post){return/*#__PURE__*/_jsx(Post,_objectSpread(_objectSpread({},post),{},{setPosts:setPosts}),post.id);}),dataLength:posts.results.length,loader:/*#__PURE__*/_jsx(Asset,{spinner:true}),hasMore:!!posts.next,next:function next(){return fetchMoreData(posts,setPosts);}}):/*#__PURE__*/_jsx(Container,{className:appStyles.Content,children:/*#__PURE__*/_jsx(Asset,{src:NoResults,message:message})})}):/*#__PURE__*/_jsx(Container,{className:appStyles.Content,children:/*#__PURE__*/_jsx(Asset,{spinner:true})})]}),/*#__PURE__*/_jsx(Col,{md:4,className:\"d-none d-lg-block p-0 p-lg-2\",children:/*#__PURE__*/_jsx(PopularProfiles,{})})]});}export default PostsPage;","map":{"version":3,"names":["React","useEffect","useState","Form","Col","Row","Container","Post","Asset","appStyles","styles","useLocation","axiosReq","NoResults","InfiniteScroll","fetchMoreData","PopularProfiles","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","PostsPage","_ref","message","_ref$filter","filter","_useState","results","_useState2","_slicedToArray","posts","setPosts","_useState3","_useState4","hasLoaded","setHasLoaded","_useLocation","pathname","_useState5","_useState6","query","setQuery","fetchPosts","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$axiosReq$get","data","wrap","_callee$","_context","prev","next","get","concat","sent","t0","console","log","stop","apply","arguments","timer","setTimeout","clearTimeout","className","children","lg","mobile","SearchIcon","SearchBar","onSubmit","event","preventDefault","Control","value","onChange","target","type","placeholder","length","map","post","_objectSpread","id","dataLength","loader","spinner","hasMore","Content","src","md"],"sources":["/workspace/api-django/project/frontend/src/pages/posts/PostsPage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nimport Form from \"react-bootstrap/Form\";\nimport Col from \"react-bootstrap/Col\";\nimport Row from \"react-bootstrap/Row\";\nimport Container from \"react-bootstrap/Container\";\n\nimport Post from \"./Post\";\nimport Asset from \"../../components/Asset\";\n\nimport appStyles from \"../../App.module.css\";\nimport styles from \"../../styles/PostsPage.module.css\";\nimport { useLocation } from \"react-router\";\nimport { axiosReq } from \"../../api/axiosDefaults\";\n\nimport NoResults from \"../../assets/no-results.png\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport { fetchMoreData } from \"../../utils/utils\";\nimport PopularProfiles from \"../profiles/PopularProfiles\";\n\nfunction PostsPage({ message, filter = \"\" }) {\n  const [posts, setPosts] = useState({ results: [] });\n  const [hasLoaded, setHasLoaded] = useState(false);\n  const { pathname } = useLocation();\n\n  const [query, setQuery] = useState(\"\");\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      try {\n        const { data } = await axiosReq.get(`/posts/?${filter}search=${query}`);\n        setPosts(data);\n        setHasLoaded(true);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    setHasLoaded(false);\n    const timer = setTimeout(() => {\n      fetchPosts();\n    }, 1000);\n\n    return () => {\n      clearTimeout(timer);\n    };\n  }, [filter, query, pathname]);\n\n  return (\n    <Row className=\"h-100\">\n      <Col className=\"py-2 p-0 p-lg-2\" lg={8}>\n        <PopularProfiles mobile />\n        <i className={`fas fa-search ${styles.SearchIcon}`} />\n        <Form\n          className={styles.SearchBar}\n          onSubmit={(event) => event.preventDefault()}\n        >\n          <Form.Control\n            value={query}\n            onChange={(event) => setQuery(event.target.value)}\n            type=\"text\"\n            className=\"mr-sm-2\"\n            placeholder=\"Search posts\"\n          />\n        </Form>\n\n        {hasLoaded ? (\n          <>\n            {posts.results.length ? (\n              <InfiniteScroll\n                children={posts.results.map((post) => (\n                  <Post key={post.id} {...post} setPosts={setPosts} />\n                ))}\n                dataLength={posts.results.length}\n                loader={<Asset spinner />}\n                hasMore={!!posts.next}\n                next={() => fetchMoreData(posts, setPosts)}\n              />\n            ) : (\n              <Container className={appStyles.Content}>\n                <Asset src={NoResults} message={message} />\n              </Container>\n            )}\n          </>\n        ) : (\n          <Container className={appStyles.Content}>\n            <Asset spinner />\n          </Container>\n        )}\n      </Col>\n      <Col md={4} className=\"d-none d-lg-block p-0 p-lg-2\">\n        <PopularProfiles />\n      </Col>\n    </Row>\n  );\n}\n\nexport default PostsPage;"],"mappings":"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"},"metadata":{},"sourceType":"module"}